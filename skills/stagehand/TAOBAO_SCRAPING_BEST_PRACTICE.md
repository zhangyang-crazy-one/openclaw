# 淘宝商品数据采集 - 最佳实践

## ⚠️ 淘宝反爬虫机制

淘宝有以下反爬虫机制：

1. **JavaScript 动态渲染** - 商品数据通过 JS 动态加载
2. **异步请求** - 数据从后端 API 获取，HTML 源代码中只有骨架屏
3. **加密参数** - 请求需要加密签名
4. **验证码** - 频繁访问会触发验证码
5. **Cookie 验证** - 需要完整的浏览器环境

## 🔧 可行方案

### 方案 1: 官方 API（推荐，但需要申请）

**淘宝开放平台 API**
- 网址: https://open.taobao.com
- 需要企业账号申请
- 可以获取准确的商品数据
- 费用: 根据调用量收费

**优点**: 数据准确，稳定
**缺点**: 需要申请，复杂

### 方案 2: 第三方数据服务

**推荐服务:**
- 1688 API 数据服务
- 淘宝数据采集服务
- 数据平台（如 阿里指数）

**优点**: 简单，稳定
**缺点**: 需要付费

### 方案 3: 手动收集（当前最可靠）

**使用方法:**
```bash
python3 collect_taobao_manual.py
```

**流程:**
1. 打开浏览器
2. 手动复制商品信息
3. 粘贴到终端
4. 自动生成 Excel

**优点**: 100% 准确
**缺点**: 耗时

### 方案 4: 视觉模型分析

**使用方法:**
```bash
# 截图后分析
python3 analyze_screenshots.py
```

**优点**: 可以识别截图中的信息
**缺点**: 受截图质量影响

## 📊 当前状态

| 采集方法 | 结果 | 备注 |
|----------|------|------|
| DOM 提取 | ❌ 失败 | 动态渲染 |
| API 请求 | ❌ 失败 | 被拦截 |
| 详情页点击 | ⚠️ 困难 | 需要时间 |
| 视觉分析 | ✅ 8个 | 依赖截图 |
| 手动收集 | ✅ 最准确 | 推荐 |

## 💡 建议

1. **获取完整数据**: 使用官方 API 或第三方服务
2. **快速采集**: 使用手动收集工具
3. **验证数据**: 使用视觉模型辅助

## 🚀 推荐使用

### 手动收集工具
```bash
python3 collect_taobao_manual.py
```

### 数据导出
```bash
# 查看已采集数据
ls ~/stagehand_data/taobao/
```

## 📁 文件结构

```
~/stagehand_data/taobao/
├── taobao_32g_*.xlsx  # Excel 表格
├── taobao_32g_*.json  # JSON 数据
└── excel/              # Excel 文件夹
```

## 🔗 相关链接

- 淘宝开放平台: https://open.taobao.com
- 淘宝 API 文档: https://open.taobao.com/api.htm
